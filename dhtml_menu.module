<?php
// $Id$

/**
 * @file dhtml_menu.module
 * Adds preprocessors to the menu theming functions
 * that will add dynamic expansion to their menus.
 */

/**
 * A serialized array of default settings. Constants must be strings.
 */
define('DHTML_MENU_DEFAULT_SETTINGS', serialize(array(
  'animations' => array(
     'height' => 'height',
     'opacity' => 'opacity'
   ),
  'speed' => 500,
  'siblings' => 'none',
  'children' => 'none',
  'nav' => 'pseudo-child',
)));

/**
 * Implementation of hook_init().
 * Adds CSS, Javascript and settings to the page.
 */
function dhtml_menu_init() {
  drupal_add_css(drupal_get_path('module', 'dhtml_menu') .'/dhtml_menu.css');
  drupal_add_js(drupal_get_path('module', 'dhtml_menu') .'/dhtml_menu.js');

  $settings = unserialize(DHTML_MENU_DEFAULT_SETTINGS);

  foreach ($settings as $setting => &$value) {
    $value = variable_get("dhtml_menu_$setting", $value);
  }
  drupal_add_js(array('dhtmlMenu' => $settings), 'setting');
}

/**
 * Implementation of hook_help().
 * @TODO: Move this to dhtml_menu.rebuild.inc once hook_help is no longer called on every page.
 */
function dhtml_menu_help($path) {
  switch ($path) {
    case 'admin/settings/dhtml_menu':
      return t('<em>DHTML Menu</em> adds dynamic functionality to the menus of your site. Ordinarily, reaching the child elements below an item requires you to visit its page. With DHTML Menu, clicking on an item with child elements will expand it without leaving the page, saving time. You can reach the actual page of such an item either by double-clicking on it or visiting the small extra link that will be shown right below it when expanded.');
  }
}

